{% extends "base.html" %}
{% load staticfiles %}

{% block title %}
<title>Bass Culture | {{ content.short_title }}</title>
{% endblock %}

{% block styles %}
    <link rel="stylesheet" href="{% static 'css/diva.min.css' %}">
{% endblock %}

{% block body %}
    <div class="col-xs-4" style="height: 700px; overflow: scroll;">

    <h2>{{ content.source_title }}</h2>
        <h4>by {{ content.source_author }}</h4>    
<hr />
<div class="tunes">
    <div class="panel-group" id="accordion">
        <div class="panel panel-default">
            <div class="panel-heading">
                <h4 class="panel-title">
                    <a data-toggle="collapse" data-parent="#accordion" href="#collapseOne">Show tunes</a>
                </h4>
            </div>
            <div id="collapseOne" class="panel-collapse collapse">
                <div class="panel-body">
                        {% for tune in content.tunes|dictsort:"start_page" %}
                <li><a href="#" class="tune-page-link" data-page="{{ tune.start_page }}">{{ tune.name }}</a> (p. {{ tune.start_page }})</li>
                        {% endfor %}
<!--                         {% for tune in content.tunes|dictsort:"start_page" %}
                <li><a href="{{ tune.url }}">{{ tune.name }}</a> (p. {{ tune.start_page }})</li>
                        {% endfor %} -->
                </div>
            </div>
        </div>
    </div>
        <div class="panel panel-default">
            <div class="panel-heading">
                <h4 class="panel-title">
                    <a data-toggle="collapse" data-parent="#accordion" href="#collapseTwo">Item details</a>
                </h4>
            </div>
            <div id="collapseTwo" class="panel-collapse collapse">
                <div class="panel-body">

                    <h4>Seller</h4>
                    <p>{{ content.seller }}</p>

                    <h4>Item notes</h4>
                    <p>{{ content.item_notes }}</p>

                    <h4>Publisher</h4>
                    <p>{{ content.source_publisher }}</p>

                    <h4>Printer</h4>
                    <p>{{ content.source_printer }}</p>

                    <h4>Date</h4>
                    <p>{{ content.source_date }}</p>

                    <h4>RISM</h4>
                    <p>{{ content.source_rism }}</p>

                    <h4>Pagination</h4>
                    <p>{{ content.pagination }}</p>

                    <h4>Orientation</h4>
                    <p>{{ content.source_orientation }}</p>

                    <h4>Dimensions</h4>
                    <p>{{ content.dimensions }}</p>

                    <h4>Shelfmark</h4>
                    <p>{{ content.shelfmark }}</p>

                    <h4>Library</h4>
                    <p>{{ content.library }}</p>

                    <h4>Edition</h4>
                    <p>{{ content.source_edition }}</p>

                    <h4>Gore</h4>
                    <p>{{ content.source_gore }}</p>

                </div>
            </div>
        </div>
    </div>
</div>
    <div class="col-xs-8">
        <div id="diva-wrapper"></div>
    </div>
{% endblock %}

{% block scripts %}
    <script src="{% static 'js/diva.min.js' %}" type="text/javascript" charset="utf-8"></script>
    <script src="{% static 'js/bassculture.js' %}" type="text/javascript"></script>
    <script type="text/javascript">
        $('#diva-wrapper').diva({
            enableAutoHeight: true,
            fixedHeightGrid: false,
            enableAutoTitle: false,
            iipServerURL: "{{ IIP_SERVER }}",
            objectData: "{{ DIVA_OBJECT_DATA }}" + "{{ content.id }}.json",
            imageDir: "{{ IIP_SERVER_IMAGE_PATH }}" + "{{ content.id }}",
            enableCanvas: true,
            enableDownload: true
        });
    </script>
    <script type="text/javascript">
        $('.tune-page-link').click(function(e)
        {
            var pageNum = $(this).data('page');
            var diva = $('#diva-wrapper').data('diva');
            diva.gotoPageByNumber(pageNum);
            console.log(pageNum)
            e.preventDefault();
        });
    </script>
{% endblock %}